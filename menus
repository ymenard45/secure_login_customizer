<?php
/*
Plugin Name: SecureLoginCustomizer
Plugin URI: https://www.example.com/
Description: A plugin for customizing login and security settings in WordPress.
Version: 1.0
Author: Your Name
Author URI: https://www.example.com/
Text Domain: secure-login-customizer
*/

// Load the language files
/* function secure_login_customizer_load_textdomain() {
    load_plugin_textdomain( 'secure-login-customizer', false, dirname( plugin_basename( __FILE__ ) ) . '/languages/' );
}
add_action( 'plugins_loaded', 'secure_login_customizer_load_textdomain' );
 */
 
// Create the menu in WordPress
function secure_login_customizer_create_menu() {
    add_submenu_page(
        'plugins.php',
        __( 'Secure Login Customizer', 'secure-login-customizer' ),
        __( 'Secure Login Customizer', 'secure-login-customizer' ),
        'manage_options',
        'secure-login-customizer-settings',
        'secure_login_customizer_settings_page'
    );
}
add_action( 'admin_menu', 'secure_login_customizer_create_menu' );

// Render the settings page
function secure_login_customizer_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php echo __('Secure Login Customizer', 'secure-login-customizer'); ?></h1>
        <h2 class="nav-tab-wrapper">
            <a href="#" class="nav-tab"><?php echo __('Tab 1', 'secure-login-customizer'); ?></a>
            <a href="#" class="nav-tab"><?php echo __('Tab 2', 'secure-login-customizer'); ?></a>
            <a href="#" class="nav-tab"><?php echo __('Tab 3', 'secure-login-customizer'); ?></a>
            <a href="#" class="nav-tab"><?php echo __('Tab 4', 'secure-login-customizer'); ?></a>
            <a href="#" class="nav-tab"><?php echo __('Tab 5', 'secure-login-customizer'); ?></a>
        </h2>
        <form method="post" action="options.php">
            <?php
            settings_fields('secure-login-customizer');
            do_settings_sections('secure-login-customizer');
            submit_button();
            ?>
        </form>
    </div>
    <?php
}

// Register the settings sections and fields
add_action('admin_init', 'secure_login_customizer_register_settings');
function secure_login_customizer_register_settings() {
    // Tab 1
    add_settings_section(
        'secure-login-customizer-tab1',
        __('Tab 1 Settings', 'secure-login-customizer'),
        'secure_login_customizer_tab1_section',
        'secure-login-customizer'
    );
    add_settings_field(
        'secure-login-customizer-enable-2fa',
        __('Enable 2FA authentication', 'secure-login-customizer'),
        'secure_login_customizer_enable_2fa_field',
        'secure-login-customizer',
        'secure-login-customizer-tab1'
    );
    add_settings_field(
        'secure-login-customizer-enable-backup-codes',
        __('Enable backup codes', 'secure-login-customizer'),
        'secure_login_customizer_enable_backup_codes_field',
        'secure-login-customizer',
        'secure-login-customizer-tab1'
    );
    add_settings_field(
        'secure-login-customizer-disable-2fa-deactivation',
        __('Disable 2FA deactivation', 'secure-login-customizer'),
        'secure_login_customizer_disable_2fa_deactivation_field',
        'secure-login-customizer',
        'secure-login-customizer-tab1'
    );
    add_settings_field(
        'secure-login-customizer-select-security-groups',
        __('Select security groups', 'secure-login-customizer'),
        'secure_login_customizer_select_security_groups_field',
        'secure-login-customizer',
        'secure-login-customizer-tab1'
    );
    
	// Tab 2 - Security
	add_settings_section(
		'securelogincustomizer_security_section',
		__('Security', 'securelogincustomizer'),
		'securelogincustomizer_security_section_cb',
		'securelogincustomizer_security'
	);

	// Security headers
	add_settings_field(
		'securelogincustomizer_security_headers',
		__('Activate Security Headers', 'securelogincustomizer'),
		'securelogincustomizer_checkbox_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_security_headers',
			'name' => 'securelogincustomizer_settings[security_headers]',
			'description' => __('Activate security headers to enhance website security', 'securelogincustomizer'),
			'value' => isset($settings['security_headers']) ? $settings['security_headers'] : '',
		]
	);

	// Anonymize login error messages
	add_settings_field(
		'securelogincustomizer_anonymize_login_errors',
		__('Anonymize Login Error Messages', 'securelogincustomizer'),
		'securelogincustomizer_checkbox_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_anonymize_login_errors',
			'name' => 'securelogincustomizer_settings[anonymize_login_errors]',
			'description' => __('Hide error messages on login page to prevent information leakage', 'securelogincustomizer'),
			'value' => isset($settings['anonymize_login_errors']) ? $settings['anonymize_login_errors'] : '',
		]
	);

	// Block connections from proxy servers
	add_settings_field(
		'securelogincustomizer_block_proxy_connections',
		__('Block Connections from Proxy Servers', 'securelogincustomizer'),
		'securelogincustomizer_checkbox_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_block_proxy_connections',
			'name' => 'securelogincustomizer_settings[block_proxy_connections]',
			'description' => __('Block connections from proxy servers to prevent attacks and spam', 'securelogincustomizer'),
			'value' => isset($settings['block_proxy_connections']) ? $settings['block_proxy_connections'] : '',
		]
	);

	// Block weak passwords
	add_settings_field(
	'securelogincustomizer_block_weak_passwords',
	__('Block Weak Passwords', 'securelogincustomizer'),
	'securelogincustomizer_checkbox_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_block_weak_passwords',
	'name' => 'securelogincustomizer_settings[block_weak_passwords]',
	'description' => __('Block weak passwords to enhance website security', 'securelogincustomizer'),
	'value' => isset($settings['block_weak_passwords']) ? $settings['block_weak_passwords'] : '',
	]
	);

	// Blacklist
	add_settings_field(
	'securelogincustomizer_blacklist',
	__('Blacklist', 'securelogincustomizer'),
	'securelogincustomizer_textarea_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_blacklist',
	'name' => 'securelogincustomizer_settings[blacklist]',
	'description' => __('Enter IP addresses that you want to block. Separate each IP address with a comma.', 'securelogincustomizer'),
	'value' => isset($settings['blacklist']) ? $settings['blacklist'] : '',
	]
	);

	// Whitelist
	add_settings_field(
	'securelogincustomizer_whitelist',
	__('Whitelist', 'securelogincustomizer'),
	'securelogincustomizer_textarea_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_whitelist',
	'name' => 'securelogincustomizer_settings[whitelist]',
	'description' => __('Enter IP addresses that you want to whitelist. Separate each IP address with a comma.', 'securelogincustomizer'),
	'value' => isset($settings['whitelist']) ? $settings['whitelist'] : '',
	]
	);

	// Number of login attempts before disabling account
	add_settings_field(
		'securelogincustomizer_login_attempts_before_disabling',
		__('Number of login attempts before disabling account', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_login_attempts_before_disabling',
			'name' => 'securelogincustomizer_settings[login_attempts_before_disabling]',
			'description' => __('Enter the number of failed login attempts before the user account is disabled. Set to 0 for never disabling the user account.', 'securelogincustomizer'),
			'value' => isset($settings['login_attempts_before_disabling']) ? $settings['login_attempts_before_disabling'] : '',
			'type' => 'number',
			'min' => 0,
			'max' => 20,
		]
	);

	// Account blocking time
	add_settings_field(
		'securelogincustomizer_account_blocking_time',
		__('Account Blocking Time', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_account_blocking_time',
			'name' => 'securelogincustomizer_settings[account_blocking_time]',
			'description' => __('Enter the time in minutes for blocking the user account after the maximum number of failed login attempts is reached. Set to 0 for no blocking time.', 'securelogincustomizer'),
			'value' => isset($settings['account_blocking_time']) ? $settings['account_blocking_time'] : '',
			'type' => 'number',
			'min' => 0,
			'max' => 300,
		]
	);

	// Security headers
	add_settings_field(
	'securelogincustomizer_security_headers',
	__('Security Headers', 'securelogincustomizer'),
	'securelogincustomizer_checkbox_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_security_headers',
	'name' => 'securelogincustomizer_settings[security_headers]',
	'description' => __('Add security headers to enhance website security', 'securelogincustomizer'),
	'value' => isset($settings['security_headers']) ? $settings['security_headers'] : '',
	]
	);

	// Anonymize user messages
	add_settings_field(
	'securelogincustomizer_anonymize_messages',
	__('Anonymize User Messages', 'securelogincustomizer'),
	'securelogincustomizer_checkbox_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_anonymize_messages',
	'name' => 'securelogincustomizer_settings[anonymize_messages]',
	'description' => __('Anonymize user messages to prevent sensitive data leakage', 'securelogincustomizer'),
	'value' => isset($settings['anonymize_messages']) ? $settings['anonymize_messages'] : '',
	]
	);

	// Block connections from proxy
	add_settings_field(
	'securelogincustomizer_block_proxy_connections',
	__('Block Proxy Connections', 'securelogincustomizer'),
	'securelogincustomizer_checkbox_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_block_proxy_connections',
	'name' => 'securelogincustomizer_settings[block_proxy_connections]',
	'description' => __('Block connections from proxy to enhance website security', 'securelogincustomizer'),
	'value' => isset($settings['block_proxy_connections']) ? $settings['block_proxy_connections'] : '',
	]
	);

	// Whitelist IPs
	add_settings_field(
	'securelogincustomizer_whitelist_ips',
	__('Whitelist IPs', 'securelogincustomizer'),
	'securelogincustomizer_text_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_whitelist_ips',
	'name' => 'securelogincustomizer_settings[whitelist_ips]',
	'description' => __('Comma separated list of IPs to whitelist', 'securelogincustomizer'),
	'value' => isset($settings['whitelist_ips']) ? $settings['whitelist_ips'] : '',
	]
	);

	// Blacklist IPs
	add_settings_field(
	'securelogincustomizer_blacklist_ips',
	__('Blacklist IPs', 'securelogincustomizer'),
	'securelogincustomizer_text_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_blacklist_ips',
	'name' => 'securelogincustomizer_settings[blacklist_ips]',
	'description' => __('Comma separated list of IPs to blacklist', 'securelogincustomizer'),
	'value' => isset($settings['blacklist_ips']) ? $settings['blacklist_ips'] : '',
	]
	);

	// Block weak passwords
	add_settings_field(
	'securelogincustomizer_block_weak_passwords',
	__('Block Weak Passwords', 'securelogincustomizer'),
	'securelogincustomizer_checkbox_field_cb',
	'securelogincustomizer_security',
	'securelogincustomizer_security_section',
	[
	'id' => 'securelogincustomizer_block_weak_passwords',
	'name' => 'securelogincustomizer_settings[block_weak_passwords]',
	'description' => __('Block weak passwords to enhance website security', 'securelogincustomizer'),
	'value' => isset($settings['block_weak_passwords']) ? $settings['block_weak_passwords'] : '',
	]
	);

	// Anonymize error messages
	add_settings_field(
		'securelogincustomizer_anonymize_error_messages',
		__('Anonymize Error Messages', 'securelogincustomizer'),
		'securelogincustomizer_checkbox_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_anonymize_error_messages',
			'name' => 'securelogincustomizer_settings[anonymize_error_messages]',
			'description' => __('Anonymize error messages for security reasons', 'securelogincustomizer'),
			'value' => isset($settings['anonymize_error_messages']) ? $settings['anonymize_error_messages'] : '',
		]
	);

	// Blacklist
	add_settings_field(
		'securelogincustomizer_blacklist',
		__('Blacklist', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_blacklist',
			'name' => 'securelogincustomizer_settings[blacklist]',
			'description' => __('Enter IPs or CIDR ranges to blacklist, separated by comma', 'securelogincustomizer'),
			'value' => isset($settings['blacklist']) ? $settings['blacklist'] : '',
			'type' => 'textarea',
			'rows' => 3,
		]
	);

	// Whitelist
	add_settings_field(
		'securelogincustomizer_whitelist',
		__('Whitelist', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_whitelist',
			'name' => 'securelogincustomizer_settings[whitelist]',
			'description' => __('Enter IPs or CIDR ranges to whitelist, separated by comma', 'securelogincustomizer'),
			'value' => isset($settings['whitelist']) ? $settings['whitelist'] : '',
			'type' => 'textarea',
			'rows' => 3,
		]
	);

	// Account blocking duration
	add_settings_field(
		'securelogincustomizer_account_blocking_duration',
		__('Account Blocking Duration', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_security',
		'securelogincustomizer_security_section',
		[
			'id' => 'securelogincustomizer_account_blocking_duration',
			'name' => 'securelogincustomizer_settings[account_blocking_duration]',
			'description' => __('Enter the duration in minutes for blocking the user account after a certain number of failed login attempts. Set to 0 for not blocking the user account.', 'securelogincustomizer'),
			'value' => isset($settings['account_blocking_duration']) ? $settings['account_blocking_duration'] : '',
			'type' => 'number',
			'min' => 0,
			'max' => 300,
		]
	);

	// Tab 3: Custom Login Screen
	add_settings_section(
		'securelogincustomizer_login_screen_section',
		__('Custom Login Screen', 'securelogincustomizer'),
		'securelogincustomizer_login_screen_section_cb',
		'securelogincustomizer_login_screen'
	);

	// Logo URL field
	add_settings_field(
		'securelogincustomizer_logo_url',
		__('Logo URL', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_logo_url',
			'name' => 'securelogincustomizer_settings[logo_url]',
			'description' => __('Enter the URL of your logo', 'securelogincustomizer'),
			'value' => isset($settings['logo_url']) ? $settings['logo_url'] : '',
		]
	);

	// Desktop Image URL field
	add_settings_field(
		'securelogincustomizer_desktop_image_url',
		__('Desktop Image URL', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_desktop_image_url',
			'name' => 'securelogincustomizer_settings[desktop_image_url]',
			'description' => __('Enter the URL of your desktop image', 'securelogincustomizer'),
			'value' => isset($settings['desktop_image_url']) ? $settings['desktop_image_url'] : '',
		]
	);

	// Mobile Image URL field
	add_settings_field(
		'securelogincustomizer_mobile_image_url',
		__('Mobile Image URL', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_mobile_image_url',
			'name' => 'securelogincustomizer_settings[mobile_image_url]',
			'description' => __('Enter the URL of your mobile image', 'securelogincustomizer'),
			'value' => isset($settings['mobile_image_url']) ? $settings['mobile_image_url'] : '',
		]
	);

	// Button Color field
	add_settings_field(
		'securelogincustomizer_button_color',
		__('Button Color', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_button_color',
			'name' => 'securelogincustomizer_settings[button_color]',
			'description' => __('Enter the color of your button in hexadecimal format (#000000)', 'securelogincustomizer'),
			'value' => isset($settings['button_color']) ? $settings['button_color'] : '',
		]
	);

	// Background Color field
	add_settings_field(
		'securelogincustomizer_background_color',
		__('Background Color', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_background_color',
			'name' => 'securelogincustomizer_settings[background_color]',
			'description' => __('Enter the color of your background in hexadecimal format (#000000)', 'securelogincustomizer'),
			'value' => isset($settings['background_color']) ? $settings['background_color'] : '',
		]
	);

	// Text Color field
	add_settings_field(
		'securelogincustomizer_text_color',
		__('Text Color', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_text_color',
			'name' => 'securelogincustomizer_settings[text_color]',
			'description' => __('Enter the color of your text in hexadecimal format (#000000)', 'securelogincustomizer'),
			'value' => isset($settings['text_color']) ? $settings['text_color'] : '',
		]
	);

	// Border Color field
	add_settings_field(
		'securelogincustomizer_border_color',
		__('Border Color', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_border_color',
			'name' => 'securelogincustomizer_settings[border_color]',
			'description' => __('Enter the color of your border in hexadecimal format (#000000)', 'securelogincustomizer'),
			'value' => isset($settings['border_color']) ? $settings['border_color'] : '',
		]
	);

	// Transparency Level field
	add_settings_field(
		'securelogincustomizer_transparency_level',
		__('Transparency Level', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_transparency_level',
			'name' => 'securelogincustomizer_settings[transparency_level]',
			'description' => __('Enter the transparency level of your login screen background (0-100)', 'securelogincustomizer'),
			'value' => isset($settings['transparency_level']) ? $settings['transparency_level'] : '',
			'type' => 'number',
			'min' => 0,
			'max' => 100,
		]
	);

	 add_settings_field(
		'securelogincustomizer_background_color',
		__('Background Color', 'securelogincustomizer'),
		'securelogincustomizer_text_field_cb',
		'securelogincustomizer_login_screen',
		'securelogincustomizer_login_screen_section',
		[
			'id' => 'securelogincustomizer_background_color',
			'name' => 'securelogincustomizer_settings[background_color]',
			'description' => __('Enter the color of your background in hexadecimal format (#000000)', 'securelogincustomizer'),
			'value' => isset($settings['background_color']) ? $settings['background_color'] : '',
		]
	);

	// Tab 5 - Miscellaneous
	add_settings_section(
	'securelogincustomizer_miscellaneous_section',
	__('Miscellaneous', 'securelogincustomizer'),
	'securelogincustomizer_miscellaneous_section_cb',
	'securelogincustomizer_miscellaneous'
	);

	// Textarea field
	add_settings_field(
	'securelogincustomizer_miscellaneous_textarea',
	__('Miscellaneous Textarea', 'securelogincustomizer'),
	'securelogincustomizer_textarea_field_cb',
	'securelogincustomizer_miscellaneous',
	'securelogincustomizer_miscellaneous_section',
	[
	'id' => 'securelogincustomizer_miscellaneous_textarea',
	'name' => 'securelogincustomizer_settings[miscellaneous_textarea]',
	'description' => __('Enter any miscellaneous text or information you would like to display here', 'securelogincustomizer'),
	'value' => isset($settings['miscellaneous_textarea']) ? $settings['miscellaneous_textarea'] : '',
	'rows' => 5,
	]
	);
}
